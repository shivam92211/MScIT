# Practical Guide: Investigating a Malware Exploit

This guide will walk you through the steps to investigate a malware exploit using tools like `Wireshark`, `VirusTotal`, and `Process Explorer`. Follow the steps carefully.

---

## Prerequisites
1. A Windows-based operating system (e.g., Windows 10).
2. Administrative privileges on the system.
3. Download and install the following tools:
   - [Wireshark](https://www.wireshark.org/download.html)
   - [Process Explorer](https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer)
   - Access to [VirusTotal](https://www.virustotal.com/)

---

## Step 1: Download and Analyze the Malware Sample
1. **Download the Malware Sample**:
   - Obtain the malware sample provided in the lab (e.g., `malware.exe`).
   - Ensure you download it in a controlled environment (e.g., a virtual machine) to avoid infecting your host system.

2. **Upload the Malware Sample to VirusTotal**:
   - Go to [VirusTotal](https://www.virustotal.com/).
   - Upload the `malware.exe` file.
   - Analyze the report generated by VirusTotal to identify the type of malware, its behavior, and detection rate.

---

## Step 2: Capture Network Traffic Using Wireshark
1. **Start Wireshark**:
   - Open Wireshark on your system.
   - Select the appropriate network interface (e.g., Ethernet or Wi-Fi).

2. **Run the Malware Sample**:
   - Execute the `malware.exe` file in your controlled environment.
   - Allow it to run for a few minutes to generate network traffic.

3. **Stop Wireshark Capture**:
   - Stop the Wireshark capture after the malware has run.
   - Save the capture file for analysis (e.g., `malware_traffic.pcap`).

4. **Analyze the Network Traffic**:
   - Look for suspicious IP addresses, domains, or protocols.
   - Identify any unusual connections or data exfiltration attempts.

---

## Step 3: Monitor System Activity Using Process Explorer
1. **Start Process Explorer**:
   - Open Process Explorer on your system.
   - Ensure it is running with administrative privileges.

2. **Run the Malware Sample**:
   - Execute the `malware.exe` file again in your controlled environment.

3. **Monitor Processes**:
   - Observe the processes spawned by the malware.
   - Look for suspicious processes, such as those with random or misspelled names.

4. **Analyze Process Details**:
   - Right-click on suspicious processes and select "Properties" to view details.
   - Check the "Strings" tab for any embedded malicious commands or URLs.

---

## Step 4: Document Findings
1. **Summarize VirusTotal Results**:
   - Document the malware type, detection rate, and behavioral analysis.

2. **Summarize Wireshark Findings**:
   - List any suspicious IP addresses, domains, or protocols observed in the network traffic.

3. **Summarize Process Explorer Findings**:
   - Document the suspicious processes and their behaviors.

---

## Step 5: Clean Up
1. **Terminate Malicious Processes**:
   - Use Process Explorer to terminate any malicious processes.

2. **Remove the Malware Sample**:
   - Delete the `malware.exe` file from your system.

3. **Restore the System**:
   - If you used a virtual machine, revert it to a clean snapshot.
   - If you used a physical machine, ensure all traces of the malware are removed.

---

## Expected Results
- You should be able to identify the malware type, its behavior, and any network activity it generates.
- You should also be able to detect and terminate malicious processes using Process Explorer.

---

## Notes
- Perform this lab in a controlled environment (e.g., a virtual machine) to avoid infecting your host system.
- This practical is for educational purposes only. Do not use these tools for malicious purposes.

