# Security

# Investigating an attack on a Windows host

---

### **Step 1: Set Up the Ubuntu Environment**
1. **Update Ubuntu**:
   Ensure your Ubuntu system is up to date.
   ```bash
   sudo apt update && sudo apt upgrade -y
   ```

2. **Install Required Tools**:
   Install the necessary tools for forensic analysis and investigation.
   ```bash
   sudo apt install -y sleuthkit autopsy volatility3 wireshark ftk-imager ewf-tools yara python3-pip
   ```

3. **Install Volatility 3**:
   Volatility 3 is a memory forensics framework. Install it using pip.
   ```bash
   pip3 install volatility3
   ```

4. **Install SIFT Workstation (Optional)**:
   The SIFT Workstation is a forensic toolkit from SANS. You can install it for additional tools.
   ```bash
   sudo apt install -y sift
   ```

5. **Install Python Libraries**:
   Install additional Python libraries for analysis.
   ```bash
   pip3 install yara-python pandas matplotlib
   ```

---

### **Step 2: Acquire Evidence from the Windows Host**
1. **Create a Disk Image**:
   Use a tool like FTK Imager or `dd` to create a forensic image of the Windows host's disk.
   - On the Windows host, download and run FTK Imager.
   - Create a disk image and save it to an external drive or network share.

2. **Acquire Memory Dump**:
   Use a tool like **DumpIt** or **Belkasoft RAM Capturer** to capture the memory of the Windows host.
   - Save the memory dump file (e.g., `memory.dmp`) to an external drive or network share.

3. **Transfer Evidence to Ubuntu**:
   Copy the disk image and memory dump to your Ubuntu system for analysis.

---

### **Step 3: Analyze the Disk Image**
1. **Mount the Disk Image**:
   Use `ewfmount` to mount the disk image for analysis.
   ```bash
   sudo ewfmount /path/to/disk/image.E01 /mnt/ewf
   ```

2. **Analyze with SleuthKit/Autopsy**:
   Use Autopsy (a GUI-based tool) or SleuthKit (command-line) to analyze the disk image.
   - Launch Autopsy:
     ```bash
     autopsy
     ```
   - Create a new case and add the disk image for analysis.

3. **Search for Artifacts**:
   Look for suspicious files, deleted files, or unusual activity in the file system.

---

### **Step 4: Analyze the Memory Dump**
1. **Identify the Profile**:
   Use Volatility 3 to identify the Windows profile (OS version).
   ```bash
   python3 vol.py -f /path/to/memory.dmp windows.info
   ```

2. **Analyze Processes**:
   Check for malicious or suspicious processes.
   ```bash
   python3 vol.py -f /path/to/memory.dmp windows.pslist
   ```

3. **Check Network Connections**:
   Analyze network connections for suspicious activity.
   ```bash
   python3 vol.py -f /path/to/memory.dmp windows.netscan
   ```

4. **Scan for Malware**:
   Use YARA rules to scan for malware signatures.
   ```bash
   python3 vol.py -f /path/to/memory.dmp windows.yarascan
   ```

---

### **Step 5: Analyze Network Traffic (Optional)**
1. **Capture Network Traffic**:
   If you have a packet capture (e.g., `.pcap` file) from the Windows host, analyze it using Wireshark.
   ```bash
   wireshark /path/to/capture.pcap
   ```

2. **Look for Anomalies**:
   Check for unusual IP addresses, ports, or protocols.

---

### **Step 6: Document Findings**
1. **Create a Report**:
   Document all findings, including suspicious files, processes, network activity, and malware indicators.

2. **Preserve Evidence**:
   Ensure all evidence is stored securely and hashes (e.g., SHA-256) are recorded for integrity.

---

### **Step 7: Remediation and Prevention**
1. **Recommend Remediation Steps**:
   Based on your findings, suggest steps to clean the system and prevent future attacks.

2. **Implement Security Measures**:
   Recommend tools like antivirus, firewalls, and regular patching.

---

### **Required Tools Summary**
- **SleuthKit/Autopsy**: Disk image analysis.
- **Volatility 3**: Memory forensics.
- **Wireshark**: Network traffic analysis.
- **FTK Imager**: Disk imaging on Windows.
- **DumpIt/Belkasoft RAM Capturer**: Memory acquisition on Windows.
- **YARA**: Malware scanning.

